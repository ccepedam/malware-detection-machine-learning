#load user libraries
library('dplyr')
library('Rcpp')
#library('rjson')
#library('RJSONIO')
library('rlist')
library(caret)
library(mlbench)

#load System Libraries
library('datasets')
library('graphics') 
library('methods')
library('stats')
library('utils')

#install.packages("rgl")
# sudo apt-get install libX11-dev freeglut3 freeglut3-dev
#install.packages("clusterSim")
library("rgl", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.2")
library("clusterSim", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.2")
library("randomForest", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.2")
library("penalizedSVM", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.2")
library("compare", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.2")

####################### M1

M1L <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M1Labels.csv", header = FALSE, sep = ",")
M1Fil <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M1featuresFiltered/part-00000", header = FALSE, sep = ",")
M1Fil <- t(M1Fil)

M1L <- M1L[-1, , drop=FALSE]
M1L <- M1L[,-1 , drop=FALSE]
NumberRows <- as.numeric(nrow(M1L))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M1L <- cbind(featureNumbers ,M1L)
rownames(M1L)<-seq(1, NumberRows, by=1)

NumberRows <- as.numeric(nrow(M1Fil))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M1Fil <- cbind(featureNumbers ,M1Fil, featureNumbers)
rownames(M1Fil)<-seq(1, NumberRows, by=1)

M1Fil <- data.frame(lapply(M1Fil, as.character), stringsAsFactors=FALSE)

for (i in  1:NumberRows){
  a <- M1Fil[i,2]
  M1Fil[i,3] <- toString(M1L[a,2])
}

NumberCols <- as.numeric(ncol(M1Fil))
colnames(M1Fil)<-seq(1, NumberCols, by=1)

#############################

####################### M2

M2L <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M2Labels.csv", header = FALSE, sep = ",")
M2Fil <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M2featuresFiltered/part-00000", header = FALSE, sep = ",")
M2Fil <- t(M2Fil)

M2L <- M2L[-1, , drop=FALSE]
M2L <- M2L[,-1 , drop=FALSE]
NumberRows <- as.numeric(nrow(M2L))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M2L <- cbind(featureNumbers ,M2L)
rownames(M2L)<-seq(1, NumberRows, by=1)

NumberRows <- as.numeric(nrow(M2Fil))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M2Fil <- cbind(featureNumbers ,M2Fil, featureNumbers)
rownames(M2Fil)<-seq(1, NumberRows, by=1)

M2Fil <- data.frame(lapply(M2Fil, as.character), stringsAsFactors=FALSE)

for (i in  1:NumberRows){
  a <- M2Fil[i,2]
  M2Fil[i,3] <- toString(M2L[a,2])
}

NumberCols <- as.numeric(ncol(M2Fil))
colnames(M2Fil)<-seq(1, NumberCols, by=1)

#############################

####################### M3

M3L <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M3Labels.csv", header = FALSE, sep = ",")
M3Fil <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M3featuresFiltered/part-00000", header = FALSE, sep = ",")
M3Fil <- t(M3Fil)

M3L <- M3L[-1, , drop=FALSE]
M3L <- M3L[,-1 , drop=FALSE]
NumberRows <- as.numeric(nrow(M3L))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M3L <- cbind(featureNumbers ,M3L)
rownames(M3L)<-seq(1, NumberRows, by=1)

NumberRows <- as.numeric(nrow(M3Fil))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M3Fil <- cbind(featureNumbers ,M3Fil, featureNumbers)
rownames(M3Fil)<-seq(1, NumberRows, by=1)

M3Fil <- data.frame(lapply(M3Fil, as.character), stringsAsFactors=FALSE)

for (i in  1:NumberRows){
  a <- M3Fil[i,2]
  M3Fil[i,3] <- toString(M3L[a,2])
}

NumberCols <- as.numeric(ncol(M3Fil))
colnames(M3Fil)<-seq(1, NumberCols, by=1)

#############################

####################### M4

M4L <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M4Labels.csv", header = FALSE, sep = ",")
M4Fil <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M4featuresFiltered/part-00000", header = FALSE, sep = ",")
M4Fil <- t(M4Fil)

M4L <- M4L[-1, , drop=FALSE]
M4L <- M4L[,-1 , drop=FALSE]
NumberRows <- as.numeric(nrow(M4L))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M4L <- cbind(featureNumbers ,M4L)
rownames(M4L)<-seq(1, NumberRows, by=1)

NumberRows <- as.numeric(nrow(M4Fil))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M4Fil <- cbind(featureNumbers ,M4Fil, featureNumbers)
rownames(M4Fil)<-seq(1, NumberRows, by=1)

M4Fil <- data.frame(lapply(M4Fil, as.character), stringsAsFactors=FALSE)

for (i in  1:NumberRows){
  a <- M4Fil[i,2]
  M4Fil[i,3] <- toString(M4L[a,2])
}

NumberCols <- as.numeric(ncol(M4Fil))
colnames(M4Fil)<-seq(1, NumberCols, by=1)

#############################

####################### M5

M5L <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M5Labels.csv", header = FALSE, sep = ",")
M5Fil <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M5featuresFiltered/part-00000", header = FALSE, sep = ",")
M5Fil <- t(M5Fil)

M5L <- M5L[-1, , drop=FALSE]
M5L <- M5L[,-1 , drop=FALSE]
NumberRows <- as.numeric(nrow(M5L))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M5L <- cbind(featureNumbers ,M5L)
rownames(M5L)<-seq(1, NumberRows, by=1)

NumberRows <- as.numeric(nrow(M5Fil))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M5Fil <- cbind(featureNumbers ,M5Fil, featureNumbers)
rownames(M5Fil)<-seq(1, NumberRows, by=1)

M5Fil <- data.frame(lapply(M5Fil, as.character), stringsAsFactors=FALSE)

for (i in  1:NumberRows){
  a <- M5Fil[i,2]
  M5Fil[i,3] <- toString(M5L[a,2])
}

NumberCols <- as.numeric(ncol(M5Fil))
colnames(M5Fil)<-seq(1, NumberCols, by=1)

#############################

####################### M6

M6L <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M6Labels.csv", header = FALSE, sep = ",")
M6Fil <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M6featuresFiltered/part-00000", header = FALSE, sep = ",")
M6Fil <- t(M6Fil)

M6L <- M6L[-1, , drop=FALSE]
M6L <- M6L[,-1 , drop=FALSE]
NumberRows <- as.numeric(nrow(M6L))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M6L <- cbind(featureNumbers ,M6L)
rownames(M6L)<-seq(1, NumberRows, by=1)

NumberRows <- as.numeric(nrow(M6Fil))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M6Fil <- cbind(featureNumbers ,M6Fil, featureNumbers)
rownames(M6Fil)<-seq(1, NumberRows, by=1)

M6Fil <- data.frame(lapply(M6Fil, as.character), stringsAsFactors=FALSE)

for (i in  1:NumberRows){
  a <- M6Fil[i,2]
  M6Fil[i,3] <- toString(M6L[a,2])
}

NumberCols <- as.numeric(ncol(M6Fil))
colnames(M6Fil)<-seq(1, NumberCols, by=1)

#############################
####################### M7

M7L <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M7Labels.csv", header = FALSE, sep = ",")
M7Fil <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M7featuresFiltered/part-00000", header = FALSE, sep = ",")
M7Fil <- t(M7Fil)

M7L <- M7L[-1, , drop=FALSE]
M7L <- M7L[,-1 , drop=FALSE]
NumberRows <- as.numeric(nrow(M7L))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M7L <- cbind(featureNumbers ,M7L)
rownames(M7L)<-seq(1, NumberRows, by=1)

NumberRows <- as.numeric(nrow(M7Fil))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M7Fil <- cbind(featureNumbers ,M7Fil, featureNumbers)
rownames(M7Fil)<-seq(1, NumberRows, by=1)

M7Fil <- data.frame(lapply(M7Fil, as.character), stringsAsFactors=FALSE)

for (i in  1:NumberRows){
  a <- M7Fil[i,2]
  M7Fil[i,3] <- toString(M7L[a,2])
}

NumberCols <- as.numeric(ncol(M7Fil))
colnames(M7Fil)<-seq(1, NumberCols, by=1)

#############################

####################### M8

M8L <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M8Labels.csv", header = FALSE, sep = ",")
M8Fil <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M8featuresFiltered/part-00000", header = FALSE, sep = ",")
M8Fil <- t(M8Fil)

M8L <- M8L[-1, , drop=FALSE]
M8L <- M8L[,-1 , drop=FALSE]
NumberRows <- as.numeric(nrow(M8L))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M8L <- cbind(featureNumbers ,M8L)
rownames(M8L)<-seq(1, NumberRows, by=1)

NumberRows <- as.numeric(nrow(M8Fil))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M8Fil <- cbind(featureNumbers ,M8Fil, featureNumbers)
rownames(M8Fil)<-seq(1, NumberRows, by=1)

M8Fil <- data.frame(lapply(M8Fil, as.character), stringsAsFactors=FALSE)

for (i in  1:NumberRows){
  a <- M8Fil[i,2]
  M8Fil[i,3] <- toString(M8L[a,2])
}

NumberCols <- as.numeric(ncol(M8Fil))
colnames(M8Fil)<-seq(1, NumberCols, by=1)

#############################

####################### M9

M9L <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M9Labels.csv", header = FALSE, sep = ",")
M9Fil <- read.table("/home/carlos/Documents/KSU/THESIS/TraversingFeatures/M9featuresFiltered/part-00000", header = FALSE, sep = ",")
M9Fil <- t(M9Fil)

M9L <- M9L[-1, , drop=FALSE]
M9L <- M9L[,-1 , drop=FALSE]
NumberRows <- as.numeric(nrow(M9L))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M9L <- cbind(featureNumbers ,M9L)
rownames(M9L)<-seq(1, NumberRows, by=1)

NumberRows <- as.numeric(nrow(M9Fil))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M9Fil <- cbind(featureNumbers ,M9Fil, featureNumbers)
rownames(M9Fil)<-seq(1, NumberRows, by=1)

M9Fil <- data.frame(lapply(M9Fil, as.character), stringsAsFactors=FALSE)

for (i in  1:NumberRows){
  a <- M9Fil[i,2]
  M9Fil[i,3] <- toString(M9L[a,2])
}

NumberCols <- as.numeric(ncol(M9Fil))
colnames(M9Fil)<-seq(1, NumberCols, by=1)

#############################

MTotalLabels <- rbind(M1Fil, M2Fil, M3Fil, M4Fil, M5Fil, M6Fil, M7Fil, M8Fil, M9Fil)
NumberRows <- as.numeric(nrow(MTotalLabels))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
MTotalLabels <- cbind(featureNumbers ,MTotalLabels)
rownames(MTotalLabels)<-seq(1, NumberRows, by=1)

NumberCols <- as.numeric(ncol(MTotalLabels))
colnames(MTotalLabels)<-seq(1, NumberCols, by=1)

write.table(MTotalLabels, file = "/home/carlos/Documents/KSU/THESIS/TraversingFeatures/MTotalLabels.csv", sep = ",", row.names = FALSE, col.names = FALSE, qmethod = "double")

#################  Traversing to 5000 matrix

M5000L <- read.table("/home/carlos/Documents/KSU/THESIS/MATRICES_FR/FeatureSelRandFor/MTotalRankFeaturesByRF/TopX1reduction/MTOTALReducedFeaturesRF5000v1.csv", header = FALSE, sep = ",")

NumberRows <- as.numeric(nrow(M5000L))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M5000L <- cbind(featureNumbers ,M5000L, featureNumbers)
rownames(M5000L)<-seq(1, NumberRows, by=1)
NumberCols <- as.numeric(ncol(M5000L))
colnames(M5000L)<-seq(1, NumberCols, by=1)
M5000L <- data.frame(lapply(M5000L, as.character), stringsAsFactors=FALSE)

for (i in  1:NumberRows){
  a <- M5000L[i,2]
  M5000L[i,3] <- toString(MTotalLabels[a,4])
}

write.table(M5000L, file = "/home/carlos/Documents/KSU/THESIS/TraversingFeatures/MTotalLabels5000.csv", sep = ",", row.names = FALSE, col.names = FALSE, qmethod = "double")

#################  Traversing to 1000 matrix

M1000L <- read.table("/home/carlos/Documents/KSU/THESIS/MATRICES_FR/FeatureSelRandFor/Mtotal5000RankFeaturesByRF/TopX3reduction/MTOTALReducedFeaturesRF1000.csv", header = FALSE, sep = ",")

NumberRows <- as.numeric(nrow(M1000L))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M1000L <- cbind(featureNumbers ,M1000L, featureNumbers, featureNumbers)
rownames(M1000L)<-seq(1, NumberRows, by=1)
NumberCols <- as.numeric(ncol(M1000L))
colnames(M1000L)<-seq(1, NumberCols, by=1)
M1000L <- data.frame(lapply(M1000L, as.character), stringsAsFactors=FALSE)

for (i in  1:NumberRows){
  a <- M1000L[i,2]
  M1000L[i,3] <- M5000L[a,2]
  M1000L[i,4] <- toString(M5000L[a,3])
}

write.table(M1000L, file = "/home/carlos/Documents/KSU/THESIS/TraversingFeatures/MTotalLabels1000.csv", sep = ",", row.names = FALSE, col.names = FALSE, qmethod = "double")

#################  Traversing to 300 matrix

M300L <- read.table("/home/carlos/Documents/KSU/THESIS/MATRICES_FR/FeatureSelRandFor/Mtotal1000RankFeaturesByRF/TopX4reduction/MTOTALReducedFeaturesRF300.csv", header = FALSE, sep = ",")

NumberRows <- as.numeric(nrow(M300L))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M300L <- cbind(featureNumbers ,M300L, featureNumbers, featureNumbers)
rownames(M300L)<-seq(1, NumberRows, by=1)
NumberCols <- as.numeric(ncol(M300L))
colnames(M300L)<-seq(1, NumberCols, by=1)
M300L <- data.frame(lapply(M300L, as.character), stringsAsFactors=FALSE)

for (i in  1:NumberRows){
  a <- M300L[i,2]
  M300L[i,3] <- M1000L[a,3]
  M300L[i,4] <- toString(M1000L[a,4])
}

write.table(M300L, file = "/home/carlos/Documents/KSU/THESIS/TraversingFeatures/MTotalLabels300.csv", sep = ",", row.names = FALSE, col.names = FALSE, qmethod = "double")


#################  Traversing to 100 matrix

M100L <- read.table("/home/carlos/Documents/KSU/THESIS/MATRICES_FR/FeatureSelRandFor/Mtotal300RankFeaturesByRF/TopX5reduction/MTOTALReducedFeaturesRF100.csv", header = FALSE, sep = ",")

NumberRows <- as.numeric(nrow(M100L))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M100L <- cbind(featureNumbers ,M100L, featureNumbers, featureNumbers)
rownames(M100L)<-seq(1, NumberRows, by=1)
NumberCols <- as.numeric(ncol(M100L))
colnames(M100L)<-seq(1, NumberCols, by=1)
M100L <- data.frame(lapply(M100L, as.character), stringsAsFactors=FALSE)

for (i in  1:NumberRows){
  a <- M100L[i,2]
  M100L[i,3] <- M300L[a,3]
  M100L[i,4] <- toString(M300L[a,4])
}

write.table(M100L, file = "/home/carlos/Documents/KSU/THESIS/TraversingFeatures/MTotalLabels100.csv", sep = ",", row.names = FALSE, col.names = FALSE, qmethod = "double")

#################  Traversing to 30 matrix

M30L <- read.table("/home/carlos/Documents/KSU/THESIS/MATRICES_FR/FeatureSelRandFor/Mtotal100RankFeaturesByRF/TopX6reduction/MTOTALReducedFeaturesRF30.csv", header = FALSE, sep = ",")

NumberRows <- as.numeric(nrow(M30L))
featureNumbers <- seq(1, NumberRows, by=1)
featureNumbers <- as.data.frame(featureNumbers)
M30L <- cbind(featureNumbers ,M30L, featureNumbers, featureNumbers)
rownames(M30L)<-seq(1, NumberRows, by=1)
NumberCols <- as.numeric(ncol(M30L))
colnames(M30L)<-seq(1, NumberCols, by=1)
M30L <- data.frame(lapply(M30L, as.character), stringsAsFactors=FALSE)

for (i in  1:NumberRows){
  a <- M30L[i,2]
  M30L[i,3] <- M100L[a,3]
  M30L[i,4] <- toString(M100L[a,4])
}

write.table(M30L, file = "/home/carlos/Documents/KSU/THESIS/TraversingFeatures/MTotalLabels30.csv", sep = ",", row.names = FALSE, col.names = FALSE, qmethod = "double")

#################  Comparing best 30  Shi-q 

SQ30 <- read.table("/home/carlos/Documents/KSU/THESIS/MATRICES_FR/TOTALMATRIX/ShiQSelectorRankFeatures/MTOTALFiltered30/part-00000", header = FALSE, sep = ",")

SQ30 <- t(SQ30)
SQ30 <- as.data.frame(SQ30)


