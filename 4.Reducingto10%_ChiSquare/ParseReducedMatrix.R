#this code read the original matriz and the selected best X features (from using ChiSquare) and write the reduced matrix.


library('dplyr')
library('Rcpp')
library('rjson')
library('RJSONIO')
library('rlist')
library(caret)
library(mlbench)
library('datasets')
library('graphics')
library('grDevices')
library('methods')
library('stats')
library('utils')

#Reading Original Matrix
MYMATRIXDATA <- read.table("/pathToMatrix/Matrix.csv", header = FALSE, sep = ",")
NumberCols <- as.numeric(ncol(MYMATRIXDATA))
LABELS <- MYMATRIXDATA[,NumberCols, drop=FALSE]
MYMATRIXDATA <- MYMATRIXDATA[,-NumberCols, drop=FALSE]

#Reading filtered features
RF <- read.table("/pathtobestFeature/FeaturesFiltered", header = FALSE, sep = ",")
RF <- as.data.frame(RF)
NumberCols <- as.numeric(ncol(RF))
colnames(RF)<-seq(1, NumberCols, by=1)

RF2 <- list()
RF2<-as.data.frame(RF2)
RF2<-as.data.frame(MYMATRIXDATA[, as.numeric(RF[, 1])])
for (i in  2:NumberCols){
  RF2<-cbind(RF2, as.data.frame(MYMATRIXDATA[, as.numeric(RF[, i])]))
}

NumberCols <- as.numeric(ncol(RF2))
colnames(RF2)<-seq(1, NumberCols, by=1)

RF2 <- data.matrix(RF2, rownames.force = NA)
is.na.data.frame <- function(x)
  +     +     do.call(cbind, lapply(x, is.na))
RF2[is.na(RF2)] <- 0


#Writing filtered matrix
write.table(RF2, file = "/pathtosave/MatrixReduced.csv", sep = ",", row.names = FALSE, col.names = FALSE, qmethod = "double")

a <- rep(1, 7630)
b <- rep(2, 7272)
clase <- c(a, b)
clase<-as.data.frame(clase)
clase <- data.matrix(clase, rownames.force = NA)
is.na.data.frame <- function(x)
  +     +     do.call(cbind, lapply(x, is.na))
clase[is.na(clase)] <- 0
clase <- t(clase)
write.table(clase, file = "/pathtoSave/Class.csv", sep = ",", row.names = FALSE, col.names = FALSE, qmethod = "double")
