#This Program extrat the Report_all data from the .json files 

#load user libraries
library('dplyr')
library('Rcpp')
library('rjson')
library('RJSONIO')
#library('rlist')
library('stringr')
library('data.table')

#load System Libraries
library('datasets')
library('graphics')
library('grDevices')
library('methods')
library('stats')
library('utils')

#setting Workspace/working directory
setwd("/path/C5")


files <- list.files(pattern = ".*\\.json")
sort(files)

num <-1
x.num <- as.numeric(num)


#Initializing dataframes for all type Report-All data

DATA_FS_COPIED <- data.frame(listFSCopied=character(0), Freq = numeric(0))
DATA_FS_DELETED <- data.frame(listFSDeleted=character(0), Freq = numeric(0))
DATA_FS_DOWNLOADED <- data.frame(listFSDownloaded=character(0), Freq = numeric(0))
DATA_FS_MOVED <- data.frame(listFSMoved=character(0), Freq = numeric(0))
DATA_FS_OPENED <- data.frame(listFSOpened=character(0), Freq = numeric(0))
DATA_FS_READ <- data.frame(listFSRead=character(0), Freq = numeric(0))
DATA_FS_REPLACED <- data.frame(listFSReplaced=character(0), Freq = numeric(0))
DATA_FS_WRITTEN <- data.frame(listFSWritten=character(0), Freq = numeric(0))
DATA_FS_ALL <- data.frame(listFSALL=character(0), Freq = numeric(0))
DATA_RT_DLLS <- data.frame(listRTDlls=character(0), Freq = numeric(0))
DATA_CHARACTERSET <- data.frame(listCharacterSet=character(0), Freq = numeric(0))
DATA_CODESIZE <- data.frame(listCodeSize=character(0), Freq = numeric(0))
DATA_FLAGSMASK <- data.frame(listFlagsMask=character(0), Freq = numeric(0))
DATA_FILEOS <- data.frame(listFileOS=character(0), Freq = numeric(0))
DATA_FILETYPE <- data.frame(listFileType=character(0), Freq = numeric(0))
DATA_FTYPEEXT <- data.frame(listFTypeExt=character(0), Freq = numeric(0))
DATA_INIDATASIZE <- data.frame(listIniDataSize=character(0), Freq = numeric(0))
DATA_LanguageCode <- data.frame(listLanguageCode=character(0), Freq = numeric(0))
DATA_ObjFileType <- data.frame(listObjFileType=character(0), Freq = numeric(0))
DATA_PType <- data.frame(listPType=character(0), Freq = numeric(0))
DATA_SubSystem <- data.frame(listSubSystem=character(0), Freq = numeric(0))
DATA_Unpacker <- data.frame(listUnpacker=character(0), Freq = numeric(0))
DATA_PEEntryPoint <- data.frame(listPEEntryPoint=character(0), Freq = numeric(0))
DATA_PEMachineType <- data.frame(listPEMachineType=character(0), Freq = numeric(0))
DATA_PEEntropy <- data.frame(listPEEntropy=character(0), Freq = numeric(0))
DATA_PEFileType <- data.frame(listPEFileType=character(0), Freq = numeric(0))
DATA_PESize <- data.frame(listPESize=character(0), Freq = numeric(0))
DATA_PEOffset <- data.frame(listPEOffset=character(0), Freq = numeric(0))
DATA_IMPORTS <- data.frame(listImports=character(0), Freq = numeric(0))
DATA_SERVICES <- data.frame(listServices=character(0), Freq = numeric(0))
DATA_TRID <- data.frame(Category=c("NULL"), Percentage = 0)


#Main loop to read files and extract info
for(i in files) {
  
  print (i)
  mydataONE<-fromJSON(i)
  mydataADInfo<-mydataONE[['additional_info']]
  mydataBehaviour<-mydataADInfo[['behaviour-v1']]
  mydataFilesSys<-mydataBehaviour[['filesystem']]
  mydataRTDlls<-mydataBehaviour[['runtime-dlls']]
  mydataExiftool<-mydataADInfo[['exiftool']]
  mydataImports<-mydataADInfo[['imports']]
  mydataServices<-mydataBehaviour[['service']]
  mydataPEOverlay<-mydataADInfo[['pe-overlay']]
  
  listImports = list()
  listImports2 = list()
  listServices = list()
  listServices2 = list()
  
  ###########################################################################   IMPORTS
  
  if (length(mydataImports)==0){
    newlistImports<-data.frame(listImports=character(0), Freq = numeric(0))
  } else {
    
    for (i in mydataImports){
      for (j in i){
        listImports2<-c(listImports2, j)
      }
    }
    
    if (length(listImports2)==0){
      newlistImports<-data.frame(listImports=character(0), Freq = numeric(0))
    } else {
      
      listImports<-sapply(listImports2, function(x) x[[1]])
      newlistImports<-as.data.frame(table(listImports))
    }
  }
  DATA_IMPORTS <- merge(DATA_IMPORTS, newlistImports, by="listImports", all = TRUE)
  
  
  
  ###########################################################################   SERVICES
  
  if (length(mydataServices)==0){
    newlistServices<-data.frame(listServices=character(0), Freq = numeric(0))
  } else {
    
    for (i in mydataServices){
      for (j in i){
        listServices2<-c(listServices2, j)
      }
    }
    if (length(listServices2)==0){
      newlistServices<-data.frame(listServices=character(0), Freq = numeric(0))
    } else {
      
      listServices<-sapply(listServices2, function(x) x[[1]])
      newlistServices<-as.data.frame(table(listServices))
    }
  }
  DATA_SERVICES <- merge(DATA_SERVICES, newlistServices, by="listServices", all = TRUE)
  
  
  ########################################################################### EXIFTOOL

  listCharacterSet <- mydataExiftool["CharacterSet"]
  if (length(listCharacterSet)==0){
    newlistCharacterSet<-data.frame(listCharacterSet=character(0), Freq = numeric(0))
  } else {
    if (is.na(listCharacterSet)){
      newlistCharacterSet<-data.frame(listCharacterSet=character(0), Freq = numeric(0))
    } else {
      newlistCharacterSet<-as.data.frame(table(listCharacterSet))
    }
  }
  DATA_CHARACTERSET <- merge(DATA_CHARACTERSET, newlistCharacterSet, by="listCharacterSet", all = TRUE)
  
  listCodeSize <- mydataExiftool["CodeSize"]
  if (length(listCodeSize)==0){
    newlistCodeSize<-data.frame(listCodeSize=character(0), Freq = numeric(0))
  } else {
    if (is.na(listCodeSize)){
      newlistCodeSize<-data.frame(listCodeSize=character(0), Freq = numeric(0))
    } else {
      newlistCodeSize<-as.data.frame(table(listCodeSize))
    }
  }
  DATA_CODESIZE <- merge(DATA_CODESIZE, newlistCodeSize, by="listCodeSize", all = TRUE)
  
  listFlagsMask <- mydataExiftool["FileFlagsMask"]
  if (length(listFlagsMask)==0){
    newlistFlagsMask<-data.frame(listFlagsMask=character(0), Freq = numeric(0))
  } else {
    if (is.na(listFlagsMask)){
      newlistFlagsMask<-data.frame(listFlagsMask=character(0), Freq = numeric(0))
    } else {
      newlistFlagsMask<-as.data.frame(table(listFlagsMask))
    }
  }
  DATA_FLAGSMASK <- merge(DATA_FLAGSMASK, newlistFlagsMask, by="listFlagsMask", all = TRUE)
  
  listFileOS <- mydataExiftool["FileOS"]
  if (length(listFileOS)==0){
    newlistFileOS<-data.frame(listFileOS=character(0), Freq = numeric(0))
  } else {
    if (is.na(listFileOS)){
      newlistFileOS<-data.frame(listFileOS=character(0), Freq = numeric(0))
    } else {
      newlistFileOS<-as.data.frame(table(listFileOS))
    }
  }
  DATA_FILEOS <- merge(DATA_FILEOS, newlistFileOS, by="listFileOS", all = TRUE)
  
  listFileType <- mydataExiftool["FileType"]
  if (length(listFileType)==0){
    newlistFileType<-data.frame(listFileType=character(0), Freq = numeric(0))
  } else {
    if (is.na(listFileType)){
      newlistFileType<-data.frame(listFileType=character(0), Freq = numeric(0))
    } else {
      newlistFileType<-as.data.frame(table(listFileType))
    }
  }
  DATA_FILETYPE <- merge(DATA_FILETYPE, newlistFileType, by="listFileType", all = TRUE)
  
  listFTypeExt <- mydataExiftool["FileTypeExtension"]
  if (length(listFTypeExt)==0){
    newlistFTypeExt<-data.frame(listFTypeExt=character(0), Freq = numeric(0))
  } else {
    if (is.na(listFTypeExt)){
      newlistFTypeExt<-data.frame(listFTypeExt=character(0), Freq = numeric(0))
    } else {
      newlistFTypeExt<-as.data.frame(table(listFTypeExt))
    }
  }
  DATA_FTYPEEXT <- merge(DATA_FTYPEEXT, newlistFTypeExt, by="listFTypeExt", all = TRUE)
  
  
  listIniDataSize <- mydataExiftool["InitializedDataSize"]
  if (length(listIniDataSize)==0){
    newlistIniDataSize<-data.frame(listIniDataSize=character(0), Freq = numeric(0))
  } else {
    if (is.na(listIniDataSize)){
      newlistIniDataSize<-data.frame(listIniDataSize=character(0), Freq = numeric(0))
    } else {
      newlistIniDataSize<-as.data.frame(table(listIniDataSize))
    }
  }
  DATA_INIDATASIZE <- merge(DATA_INIDATASIZE, newlistIniDataSize, by="listIniDataSize", all = TRUE)
  
  listLanguageCode <- mydataExiftool["LanguageCode"]
  if (length(listLanguageCode)==0){
    newlistLanguageCode<-data.frame(listLanguageCode=character(0), Freq = numeric(0))
  } else {
    if (is.na(listLanguageCode)){
      newlistLanguageCode<-data.frame(listLanguageCode=character(0), Freq = numeric(0))
    } else {
      newlistLanguageCode<-as.data.frame(table(listLanguageCode))
    }
  }
  DATA_LanguageCode <- merge(DATA_LanguageCode, newlistLanguageCode, by="listLanguageCode", all = TRUE)
  
  listObjFileType <- mydataExiftool["ObjectFileType"]
  if (length(listObjFileType)==0){
    newlistObjFileType<-data.frame(listObjFileType=character(0), Freq = numeric(0))
  } else {
    if (is.na(listObjFileType)){
      newlistObjFileType<-data.frame(listObjFileType=character(0), Freq = numeric(0))
    } else {
      newlistObjFileType<-as.data.frame(table(listObjFileType))
    }
  }
  DATA_ObjFileType <- merge(DATA_ObjFileType, newlistObjFileType, by="listObjFileType", all = TRUE)
  
  listPType <- mydataExiftool["PEType"]
  if (length(listPType)==0){
    newlistPType<-data.frame(listPType=character(0), Freq = numeric(0))
  } else {
    if (is.na(listPType)){
      newlistPType<-data.frame(listPType=character(0), Freq = numeric(0))
    } else {
      newlistPType<-as.data.frame(table(listPType))
    }
  }
  DATA_PType <- merge(DATA_PType, newlistPType, by="listPType", all = TRUE)
  
  listSubSystem <- mydataExiftool["Subsystem"]
  if (length(listSubSystem)==0){
    newlistSubSystem<-data.frame(listSubSystem=character(0), Freq = numeric(0))
  } else {
    if (is.na(listSubSystem)){
      newlistSubSystem<-data.frame(listSubSystem=character(0), Freq = numeric(0))
    } else {
      newlistSubSystem<-as.data.frame(table(listSubSystem))
    }
  }
  DATA_SubSystem <- merge(DATA_SubSystem, newlistSubSystem, by="listSubSystem", all = TRUE)
  
  
  listUnpacker <- mydataADInfo[['f-prot-unpacker']]
  if (length(listUnpacker)==0){
    newlistUnpacker<-data.frame(listUnpacker=character(0), Freq = numeric(0))
  } else {
    newlistUnpacker<-as.data.frame(table(listUnpacker))
  }
  DATA_Unpacker <- merge(DATA_Unpacker, newlistUnpacker, by="listUnpacker", all = TRUE)
  
  
  listPEEntryPoint <- mydataADInfo[['pe-entry-point']]
  if (length(listPEEntryPoint)==0){
    newlistPEEntryPoint<-data.frame(listPEEntryPoint=character(0), Freq = numeric(0))
  } else {
    newlistPEEntryPoint<-as.data.frame(table(listPEEntryPoint))
  }
  DATA_PEEntryPoint <- merge(DATA_PEEntryPoint, newlistPEEntryPoint, by="listPEEntryPoint", all = TRUE)
  
  
  listPEMachineType <- mydataADInfo[['pe-machine-type']]
  if (length(listPEMachineType)==0){
    newlistPEMachineType<-data.frame(listPEMachineType=character(0), Freq = numeric(0))
  } else {
    newlistPEMachineType<-as.data.frame(table(listPEMachineType))
  }
  DATA_PEMachineType <- merge(DATA_PEMachineType, newlistPEMachineType, by="listPEMachineType", all = TRUE)
  
  
  listPEEntropy <- mydataPEOverlay[['entropy']]
  if (length(listPEEntropy)==0){
    newlistPEEntropy<-data.frame(listPEEntropy=character(0), Freq = numeric(0))
  } else {
    newlistPEEntropy<-as.data.frame(table(listPEEntropy))
  }
  DATA_PEEntropy <- merge(DATA_PEEntropy, newlistPEEntropy, by="listPEEntropy", all = TRUE)
  
  
  listPEFileType <- mydataPEOverlay[['filetype']]
  if (length(listPEFileType)==0){
    newlistPEFileType<-data.frame(listPEFileType=character(0), Freq = numeric(0))
  } else {
    newlistPEFileType<-as.data.frame(table(listPEFileType))
  }
  DATA_PEFileType <- merge(DATA_PEFileType, newlistPEFileType, by="listPEFileType", all = TRUE)
  
  
  listPESize <- mydataPEOverlay[['size']]
  if (length(listPESize)==0){
    newlistPESize<-data.frame(listPESize=character(0), Freq = numeric(0))
  } else {
    newlistPESize<-as.data.frame(table(listPESize))
  }
  DATA_PESize <- merge(DATA_PESize, newlistPESize, by="listPESize", all = TRUE)
  
  
  listPEOffset <- mydataPEOverlay[['offset']]
  if (length(listPEOffset)==0){
    newlistPEOffset<-data.frame(listPEOffset=character(0), Freq = numeric(0))
  } else {
    newlistPEOffset<-as.data.frame(table(listPEOffset))
  }
  DATA_PEOffset <- merge(DATA_PEOffset, newlistPEOffset, by="listPEOffset", all = TRUE)
  
  
  listTRID = list()
  listTRID2 = list()
  listTRID3 = list()
  listTRID4 = list()
  stringCh = ""
  stringCh2 = ""
  DT = data.frame(Category=c("NULL"), Percentage = 0)
  
  TRID <- mydataADInfo[['trid']]
  
  if (length(TRID)==0){
    
  } else {
    str_replace(TRID, "\n", " ")
    listTRID2<-strsplit(TRID, split="\n")
    listTRID3<-listTRID2[[1]]
    for (i in listTRID3){
      stringCh<-gsub("\\(|\\]", "", i)
      stringCh<-gsub("\\)|\\]", "", stringCh)
      stringCh<-gsub("", "", stringCh)
      stringCh<-str_replace(stringCh, "%", "")
      stringCh2<-str_extract(stringCh, "[0-9]*\\.[0-9]*")
      stringCh<-gsub(stringCh2, "", stringCh)
      stringCh<-str_trim(stringCh, side = c("both"))
      rbind(DT, data.frame(Category=c(stringCh), Percentage = as.numeric(stringCh2)))->DT
    }
  }
  DATA_TRID <- merge(DATA_TRID, DT, by="Category", all = TRUE)

  #########################################################################
  
  #____________________________FILES______________________________________________________________________________
  
  mydataFSCopied<-mydataFilesSys[['copied']]
  mydataFSDeleted<-mydataFilesSys[['deleted']]
  mydataFSDownloaded<-mydataFilesSys[['downloaded']]
  mydataFSMoved<-mydataFilesSys[['moved']]
  mydataFSOpened<-mydataFilesSys[['opened']]
  mydataFSRead<-mydataFilesSys[['read']]
  mydataFSReplaced<-mydataFilesSys[['replaced']]
  mydataFSWritten<-mydataFilesSys[['written']]
  
  listFSCopied2 = list()
  listFSDeleted2 = list()
  listFSDownloaded2 = list()
  listFSMoved2  = list()
  listFSOpened2  = list()
  listFSRead2  = list()
  listFSReplaced2  = list()
  listFSWritten2  = list()
  listFSALL2 = list()
  listRTDlls2 = list()
  
  ###########################################################################   DATA_RT_DLLS
  if (length(mydataRTDlls)==0){
    newlistRTDlls<-data.frame(listRTDlls=character(0), Freq = numeric(0))
  } else {
    for(i in mydataRTDlls) {
      listRTDlls2 <- c(listRTDlls2, i[['file']])
    }
    listRTDlls<-sapply(listRTDlls2, function(x) x[[1]])
    newlistRTDlls<-as.data.frame(table(listRTDlls))
  }
  DATA_RT_DLLS <- merge(DATA_RT_DLLS, newlistRTDlls, by="listRTDlls", all = TRUE)
  
  ###########################################################################   DATA_FS_COPIED
  if (length(mydataFSCopied)==0){
    newlistFSCopied<-data.frame(listFSCopied=character(0), Freq = numeric(0))
  } else {
    for(i in mydataFSCopied) {
      listFSCopied2 <- c(listFSCopied2, i[['dst']])
      listFSCopied2 <- c(listFSCopied2, i[['src']])
      listFSALL2 <- c(listFSALL2, i[['dst']])
      listFSALL2 <- c(listFSALL2, i[['src']])
    }
    listFSCopied<-sapply(listFSCopied2, function(x) x[[1]])
    newlistFSCopied<-as.data.frame(table(listFSCopied))
  }
  DATA_FS_COPIED <- merge(DATA_FS_COPIED, newlistFSCopied, by="listFSCopied", all = TRUE)
  
  ###########################################################################     DATA_FS_DELETED
  
  if (length(mydataFSDeleted)==0){
    newlistFSDeleted<-data.frame(listFSDeleted=character(0), Freq = numeric(0))
  } else {
    for(i in mydataFSDeleted) {
      listFSDeleted2 <- c(listFSDeleted2, i[['path']])
      listFSALL2 <- c(listFSALL2, i[['path']])
    }
    listFSDeleted<-sapply(listFSDeleted2, function(x) x[[1]])
    newlistFSDeleted<-as.data.frame(table(listFSDeleted))
  }
  DATA_FS_DELETED <- merge(DATA_FS_DELETED, newlistFSDeleted, by="listFSDeleted", all = TRUE)
  
  ###########################################################################   DATA_FS_DOWNLOADED
  
  if (length(mydataFSDownloaded)==0){
    newlistFSDownloaded<-data.frame(listFSDownloaded=character(0), Freq = numeric(0))
  } else {
    for(i in mydataFSDownloaded) {
      listFSDownloaded2 <- c(listFSDownloaded2, i[['path']])
    }
    listFSDownloaded<-sapply(listFSDownloaded2, function(x) x[[1]])
    newlistFSDownloaded<-as.data.frame(table(listFSDownloaded))
  }
  DATA_FS_DOWNLOADED <- merge(DATA_FS_DOWNLOADED, newlistFSDownloaded, by="listFSDownloaded", all = TRUE)
  
  ###########################################################################   DATA_FS_MOVED
  
  if (length(mydataFSMoved)==0){
    newlistFSMoved<-data.frame(listFSMoved=character(0), Freq = numeric(0))
  } else {
    for(i in mydataFSMoved) {
      listFSMoved2 <- c(listFSMoved2, i[['dst']])
      listFSMoved2 <- c(listFSMoved2, i[['src']])
      listFSALL2 <- c(listFSALL2, i[['dst']])
      listFSALL2 <- c(listFSALL2, i[['src']])
    }
    listFSMoved<-sapply(listFSMoved2, function(x) x[[1]])
    newlistFSMoved<-as.data.frame(table(listFSMoved))
  }
  DATA_FS_MOVED <- merge(DATA_FS_MOVED, newlistFSMoved, by="listFSMoved", all = TRUE)
  
  
  ###########################################################################   DATA_FS_OPENED
  
  if (length(mydataFSOpened)==0){
    newlistFSOpened<-data.frame(listFSOpened=character(0), Freq = numeric(0))
  } else {
    for(i in mydataFSOpened) {
      listFSOpened2 <- c(listFSOpened2, i[['path']])
      listFSALL2 <- c(listFSALL2, i[['path']])
    }
    listFSOpened<-sapply(listFSOpened2, function(x) x[[1]])
    newlistFSOpened<-as.data.frame(table(listFSOpened))
  }
  DATA_FS_OPENED <- merge(DATA_FS_OPENED, newlistFSOpened, by="listFSOpened", all = TRUE)
  
  
  ###########################################################################   DATA_FS_READ
  
  if (length(mydataFSRead)==0){
    newlistFSRead<-data.frame(listFSRead=character(0), Freq = numeric(0))
  } else {
    for(i in mydataFSRead) {
      listFSRead2 <- c(listFSRead2, i[['path']])
      listFSALL2 <- c(listFSALL2, i[['path']])
    }
    listFSRead<-sapply(listFSRead2, function(x) x[[1]])
    newlistFSRead<-as.data.frame(table(listFSRead))
  }
  DATA_FS_READ <- merge(DATA_FS_READ, newlistFSRead, by="listFSRead", all = TRUE)
  
  
  ###########################################################################   DATA_FS_REPLACED
  
  if (length(mydataFSReplaced)==0){
    newlistFSReplaced<-data.frame(listFSReplaced=character(0), Freq = numeric(0))
  } else {
    for(i in mydataFSReplaced) {
      listFSReplaced2 <- c(listFSReplaced2, i[['replaced']])
      listFSALL2 <- c(listFSALL2, i[['replaced']])
    }
    listFSReplaced<-sapply(listFSReplaced2, function(x) x[[1]])
    newlistFSReplaced<-as.data.frame(table(listFSReplaced))
  }
  DATA_FS_REPLACED <- merge(DATA_FS_REPLACED, newlistFSReplaced, by="listFSReplaced", all = TRUE)
  
  
  ###########################################################################   DATA_FS_WRITTEN
  
  if (length(mydataFSWritten)==0){
    newlistFSWritten<-data.frame(listFSWritten=character(0), Freq = numeric(0))
  } else {
    for(i in mydataFSWritten) {
      listFSWritten2 <- c(listFSWritten2, i[['path']])
      listFSALL2 <- c(listFSALL2, i[['path']])
    }
    listFSWritten<-sapply(listFSWritten2, function(x) x[[1]])
    newlistFSWritten<-as.data.frame(table(listFSWritten))
  }
  DATA_FS_WRITTEN <- merge(DATA_FS_WRITTEN, newlistFSWritten, by="listFSWritten", all = TRUE)
  
  
  ###########################################################################   DATA_FS_ALL
  
  if (length(listFSALL2)==0){
    newlistFSALL<-data.frame(listFSALL=character(0), Freq = numeric(0))
  } else {
    listFSALL<-sapply(listFSALL2, function(x) x[[1]])
    newlistFSALL<-as.data.frame(table(listFSALL))
  }
  DATA_FS_ALL <- merge(DATA_FS_ALL, newlistFSALL, by="listFSALL", all = TRUE)

  ########################################################## 
  ##########################################################
  
  
  x.num <- x.num+1
}


##DATA was grouped and writed on 26 files T1 to T31. C'X' refers to subBlocks of the original dataset 

DATA_FS_ALL <- DATA_FS_ALL[,-(2), drop=FALSE]
NumberCols <- as.numeric(ncol(DATA_FS_ALL))
colnames(DATA_FS_ALL)<-seq(1, NumberCols, by=1)
write.table(DATA_FS_ALL, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T1.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_FS_COPIED <- DATA_FS_COPIED[,-(2), drop=FALSE]
colnames(DATA_FS_COPIED)<-seq(1, NumberCols, by=1)
write.table(DATA_FS_COPIED, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T2.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_FS_DELETED <- DATA_FS_DELETED[,-(2), drop=FALSE]
colnames(DATA_FS_DELETED)<-seq(1, NumberCols, by=1)
write.table(DATA_FS_DELETED, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T3.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_FS_DOWNLOADED <- DATA_FS_DOWNLOADED[,-(2), drop=FALSE]
colnames(DATA_FS_DOWNLOADED)<-seq(1, NumberCols, by=1)
write.table(DATA_FS_DOWNLOADED, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T4.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_FS_MOVED <- DATA_FS_MOVED[,-(2), drop=FALSE]
colnames(DATA_FS_MOVED)<-seq(1, NumberCols, by=1)
write.table(DATA_FS_MOVED, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T5.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_FS_OPENED <- DATA_FS_OPENED[,-(2), drop=FALSE]
colnames(DATA_FS_OPENED)<-seq(1, NumberCols, by=1)
write.table(DATA_FS_OPENED, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T6.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_FS_READ <- DATA_FS_READ[,-(2), drop=FALSE]
colnames(DATA_FS_READ)<-seq(1, NumberCols, by=1)
write.table(DATA_FS_READ, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T7.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_FS_REPLACED <- DATA_FS_REPLACED[,-(2), drop=FALSE]
colnames(DATA_FS_REPLACED)<-seq(1, NumberCols, by=1)
write.table(DATA_FS_REPLACED, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T8.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_FS_WRITTEN <- DATA_FS_WRITTEN[,-(2), drop=FALSE]
colnames(DATA_FS_WRITTEN)<-seq(1, NumberCols, by=1)
write.table(DATA_FS_WRITTEN, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T9.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_RT_DLLS <- DATA_RT_DLLS[,-(2), drop=FALSE]
colnames(DATA_RT_DLLS)<-seq(1, NumberCols, by=1)
write.table(DATA_RT_DLLS, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T10.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_CHARACTERSET <- DATA_CHARACTERSET[,-(2), drop=FALSE]
colnames(DATA_CHARACTERSET)<-seq(1, NumberCols, by=1)
write.table(DATA_CHARACTERSET, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T11.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_CODESIZE <- DATA_CODESIZE[,-(2), drop=FALSE]
colnames(DATA_CODESIZE)<-seq(1, NumberCols, by=1)
write.table(DATA_CODESIZE, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T12.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_FLAGSMASK <- DATA_FLAGSMASK[,-(2), drop=FALSE]
colnames(DATA_FLAGSMASK)<-seq(1, NumberCols, by=1)
write.table(DATA_FLAGSMASK, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T13.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_FILEOS <- DATA_FILEOS[,-(2), drop=FALSE]
colnames(DATA_FILEOS)<-seq(1, NumberCols, by=1)
write.table(DATA_FILEOS, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T14.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_FILETYPE <- DATA_FILETYPE[,-(2), drop=FALSE]
colnames(DATA_FILETYPE)<-seq(1, NumberCols, by=1)
write.table(DATA_FILETYPE, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T15.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_FTYPEEXT <- DATA_FTYPEEXT[,-(2), drop=FALSE]
colnames(DATA_FTYPEEXT)<-seq(1, NumberCols, by=1)
write.table(DATA_FTYPEEXT, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T16.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_INIDATASIZE <- DATA_INIDATASIZE[,-(2), drop=FALSE]
colnames(DATA_INIDATASIZE)<-seq(1, NumberCols, by=1)
write.table(DATA_INIDATASIZE, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T17.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_LanguageCode <- DATA_LanguageCode[,-(2), drop=FALSE]
colnames(DATA_LanguageCode)<-seq(1, NumberCols, by=1)
write.table(DATA_LanguageCode, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T18.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_ObjFileType <- DATA_ObjFileType[,-(2), drop=FALSE]
colnames(DATA_ObjFileType)<-seq(1, NumberCols, by=1)
write.table(DATA_ObjFileType, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T19.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_PType <- DATA_PType[,-(2), drop=FALSE]
colnames(DATA_PType)<-seq(1, NumberCols, by=1)
write.table(DATA_PType, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T20.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_SubSystem <- DATA_SubSystem[,-(2), drop=FALSE]
colnames(DATA_SubSystem)<-seq(1, NumberCols, by=1)
write.table(DATA_SubSystem, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T21.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_Unpacker <- DATA_Unpacker[,-(2), drop=FALSE]
colnames(DATA_Unpacker)<-seq(1, NumberCols, by=1)
write.table(DATA_Unpacker, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T22.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_PEEntryPoint <- DATA_PEEntryPoint[,-(2), drop=FALSE]
colnames(DATA_PEEntryPoint)<-seq(1, NumberCols, by=1)
write.table(DATA_PEEntryPoint, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T23.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_PEMachineType <- DATA_PEMachineType[,-(2), drop=FALSE]
colnames(DATA_PEMachineType)<-seq(1, NumberCols, by=1)
write.table(DATA_PEMachineType, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T24.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_PEEntropy <- DATA_PEEntropy[,-(2), drop=FALSE]
colnames(DATA_PEEntropy)<-seq(1, NumberCols, by=1)
write.table(DATA_PEEntropy, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T25.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_PEFileType <- DATA_PEFileType[,-(2), drop=FALSE]
colnames(DATA_PEFileType)<-seq(1, NumberCols, by=1)
write.table(DATA_PEFileType, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T26.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_PESize <- DATA_PESize[,-(2), drop=FALSE]
colnames(DATA_PESize)<-seq(1, NumberCols, by=1)
write.table(DATA_PESize, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T27.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_PEOffset <- DATA_PEOffset[,-(2), drop=FALSE]
colnames(DATA_PEOffset)<-seq(1, NumberCols, by=1)
write.table(DATA_PEOffset, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T28.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_IMPORTS <- DATA_IMPORTS[,-(2), drop=FALSE]
colnames(DATA_IMPORTS)<-seq(1, NumberCols, by=1)
write.table(DATA_IMPORTS, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T29.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_SERVICES <- DATA_SERVICES[,-(2), drop=FALSE]
colnames(DATA_SERVICES)<-seq(1, NumberCols, by=1)
write.table(DATA_SERVICES, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T30.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_TRID <- DATA_TRID[,-(2), drop=FALSE]
colnames(DATA_TRID)<-seq(1, NumberCols, by=1)
write.table(DATA_TRID, file = "/home/gpulab2/Documents/VirusTotal/Results/JOINED/RALL/C5T31.csv", sep = ",", col.names = NA, qmethod = "double")


