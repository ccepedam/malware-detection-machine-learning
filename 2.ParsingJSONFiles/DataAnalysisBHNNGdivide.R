#This Program extrat the Behavioral data from the .json files 

#load user libraries
library('dplyr')
library('Rcpp')
library('rjson')
library('RJSONIO')
library('rlist')

#load System Libraries
library('datasets')
library('graphics')
library('grDevices')
library('methods')
library('stats')
library('utils')

#setting Workspace/working directory
setwd("/path/WD")

files <- list.files(pattern = ".*\\.json")
sort(files)

num <-1
x.num <- as.numeric(num)

#Initializing dataframes for all type behavioural data
DATA_SUM_FILES<-data.frame(SUMFiles=character(0), Freq = numeric(0))
DATA_SUM_KEYS<-data.frame(SUMKeys=character(0), Freq = numeric(0))
DATA_SUM_MUTEXES<-data.frame(SUMMutexes=character(0), Freq = numeric(0))
DATA_API<-data.frame(listAPIONE=character(0), Freq = numeric(0))
DATA_CATEGORY<-data.frame(listCategoryONE=character(0), Freq = numeric(0))
DATA_RETURN<-data.frame(listRETURNONE=character(0), Freq = numeric(0))
DATA_STATUS<-data.frame(listSTATUSONE=character(0), Freq = numeric(0))
DATA_ARGUMENTS_NAME<-data.frame(listARGUMENT_NAME=character(0), Freq = numeric(0))
DATA_ARGUMENTS_VALUE<-data.frame(listARGUMENT_VALUE=character(0), Freq = numeric(0))
DATA_FIRST_SEEN <- data.frame(listFirstSeen=character(0), Freq = numeric(0))
DATA_PARENT_ID <- data.frame(listParentId=character(0), Freq = numeric(0))
DATA_PROCESS_ID <- data.frame(listProcessId=character(0), Freq = numeric(0))
DATA_PROCESS_NAME <- data.frame(listProcessName=character(0), Freq = numeric(0))
DATA_PT_PID <- data.frame(listPTPid=character(0), Freq = numeric(0))
DATA_PT_NAME <- data.frame(listPTName=character(0), Freq = numeric(0))
DATA_NET_UDP_DPORT <- data.frame(listUDPdport=character(0), Freq = numeric(0))
DATA_NET_UDP_SPORT <- data.frame(listUDPsport=character(0), Freq = numeric(0))
DATA_NET_UDP_DST <- data.frame(listUDPdst=character(0), Freq = numeric(0))
DATA_NET_HOSTS <- data.frame(listHosts=character(0), Freq = numeric(0))
DATA_NET_DNS_HOST <- data.frame(listDNShostname=character(0), Freq = numeric(0))
DATA_NET_HTTP_HOST <- data.frame(listHTTPhost=character(0), Freq = numeric(0))
DATA_NET_HTTP_URI <- data.frame(listHTTPuri=character(0), Freq = numeric(0))
DATA_NET_HTTP_PORT <- data.frame(listHTTPport=character(0), Freq = numeric(0))
DATA_NET_TCP_DPORT <- data.frame(listTCPdport=character(0), Freq = numeric(0))
DATA_NET_TCP_SPORT <- data.frame(listTCPsport=character(0), Freq = numeric(0))
DATA_NET_TCP_DST <- data.frame(listTCPdst=character(0), Freq = numeric(0))

concat_str = character(0)
api_str = character(0)
return_str = character(0)
category_str = character(0)
status_str = character(0)
arg_name_str = character(0)
arg_value_str = character(0)

#Recursive functions
recursiveTree1 <- function(x){
  PTlist1 = list()
  if (length(x)==0){
    return(PTlist1)
  } else {
    PTName<-x[[1]][['name']]
    PTlist1 <- c(PTlist1, PTName)
    PTlist1 <- c(PTlist1, recursiveTree1(x[[1]][['children']]))
    return(PTlist1)
  }
}

recursiveTree2 <- function(x){
  PTlist2 = list()
  if (length(x)==0){
    return(PTlist2)
  } else {
    PTPid<-x[[1]][['pid']]
    PTlist2 <- c(PTlist2, PTPid)
    PTlist2 <- c(PTlist2, recursiveTree2(x[[1]][['children']]))
    return(PTlist2)
  }
}


#Main loop to read files and extract info
for(i in files) {
  print (i)
  #Initializing variables
  ngram4V1 = list()
  ngram4 = list()
  ngram2 = list()
  ngram2V1 = list()
  ngram3 = list()
  ngram3V1 = list()
  PTlist1 = list()
  PTlist2 = list()
  listFirstSeen2 = list()
  listParentId2 = list()
  listProcessId2 = list()
  listProcessName2 = list()
  listAPI2 = list()
  listCategory2 = list()
  listReturn2 = list()
  listStatus2 = list()
  listArg_Name2 = list()
  listArg_Value2 = list()
  listFILES = list()
  listKEYS = list()
  listMUTEXES = list()
  
  mydataONE<-fromJSON(i)
  mydataProcessesONE<-mydataONE[['behavior']]["processes"]
  mydataProcessTree<-mydataONE[['behavior']]["processtree"]
  mydataSummary<-mydataONE[['behavior']]["summary"]
  mydataNetwork<-mydataONE[['network']]
  
  #____________ NETWORK ______________________________________________________________________________________________
  
  ##########################################################	UDP
  UDP<-mydataNetwork[['udp']]
  listUDPdport2 = list()
  listUDPdst2 = list()
  listUDPsport2 = list()
  
  if (length(UDP)==0){
    newlistUDPdport<-data.frame(listUDPdport=character(0), Freq = numeric(0))
    newlistUDPdst<-data.frame(listUDPdst=character(0), Freq = numeric(0))
    newlistUDPsport<-data.frame(listUDPsport=character(0), Freq = numeric(0))
  } else {
    for(i in UDP) {
      listUDPdport2 <- c(listUDPdport2, i[['dport']])
      listUDPdst2 <- c(listUDPdst2, i[['dst']])
      listUDPsport2 <- c(listUDPsport2, i[['sport']])
    }
    listUDPdport<-sapply(listUDPdport2, function(x) x[[1]])
    newlistUDPdport<-as.data.frame(table(listUDPdport))
    
    listUDPdst<-sapply(listUDPdst2, function(x) x[[1]])
    newlistUDPdst<-as.data.frame(table(listUDPdst))
    
    listUDPsport<-sapply(listUDPsport2, function(x) x[[1]])
    newlistUDPsport<-as.data.frame(table(listUDPsport))
  }
  DATA_NET_UDP_DPORT <- merge(DATA_NET_UDP_DPORT, newlistUDPdport, by="listUDPdport", all = TRUE)
  DATA_NET_UDP_DST <- merge(DATA_NET_UDP_DST, newlistUDPdst, by="listUDPdst", all = TRUE)
  DATA_NET_UDP_SPORT <- merge(DATA_NET_UDP_SPORT, newlistUDPsport, by="listUDPsport", all = TRUE)
  
  ##########################################################	TCP
  TCP<-mydataNetwork[['tcp']]
  listTCPdport2 = list()
  listTCPdst2 = list()
  listTCPsport2 = list()
  
  if (length(TCP)==0){
    newlistTCPdport<-data.frame(listTCPdport=character(0), Freq = numeric(0))
    newlistTCPdst<-data.frame(listTCPdst=character(0), Freq = numeric(0))
    newlistTCPsport<-data.frame(listTCPsport=character(0), Freq = numeric(0))
  } else {
    for(i in TCP) {
      listTCPdport2 <- c(listTCPdport2, i[['dport']])
      listTCPdst2 <- c(listTCPdst2, i[['dst']])
      listTCPsport2 <- c(listTCPsport2, i[['sport']])
    }
    listTCPdport<-sapply(listTCPdport2, function(x) x[[1]])
    newlistTCPdport<-as.data.frame(table(listTCPdport))
    
    listTCPdst<-sapply(listTCPdst2, function(x) x[[1]])
    newlistTCPdst<-as.data.frame(table(listTCPdst))
    
    listTCPsport<-sapply(listTCPsport2, function(x) x[[1]])
    newlistTCPsport<-as.data.frame(table(listTCPsport))
  }
  DATA_NET_TCP_DPORT <- merge(DATA_NET_TCP_DPORT, newlistTCPdport, by="listTCPdport", all = TRUE)
  DATA_NET_TCP_DST <- merge(DATA_NET_TCP_DST, newlistTCPdst, by="listTCPdst", all = TRUE)
  DATA_NET_TCP_SPORT <- merge(DATA_NET_TCP_SPORT, newlistTCPsport, by="listTCPsport", all = TRUE)
  
    
  ##########################################################	HTTP
  HTTP<-mydataNetwork[['http']]
  listHTTPhost2 = list()
  listHTTPuri2 = list()
  listHTTPport2 = list()
  
  if (length(HTTP)==0){
    newlistHTTPhost<-data.frame(listHTTPhost=character(0), Freq = numeric(0))
    newlistHTTPuri<-data.frame(listHTTPuri=character(0), Freq = numeric(0))
    newlistHTTPport<-data.frame(listHTTPport=character(0), Freq = numeric(0))
  } else {
    for(i in HTTP) {
      listHTTPhost2 <- c(listHTTPhost2, i[['host']])
      listHTTPuri2 <- c(listHTTPuri2, i[['uri']])
      listHTTPport2 <- c(listHTTPport2, i[['port']])
    }
    listHTTPhost<-sapply(listHTTPhost2, function(x) x[[1]])
    newlistHTTPhost<-as.data.frame(table(listHTTPhost))
    
    listHTTPuri<-sapply(listHTTPuri2, function(x) x[[1]])
    newlistHTTPuri<-as.data.frame(table(listHTTPuri))
    
    listHTTPport<-sapply(listHTTPport2, function(x) x[[1]])
    newlistHTTPport<-as.data.frame(table(listHTTPport))
  }
  DATA_NET_HTTP_HOST <- merge(DATA_NET_HTTP_HOST, newlistHTTPhost, by="listHTTPhost", all = TRUE)
  DATA_NET_HTTP_URI <- merge(DATA_NET_HTTP_URI, newlistHTTPuri, by="listHTTPuri", all = TRUE)
  DATA_NET_HTTP_PORT <- merge(DATA_NET_HTTP_PORT, newlistHTTPport, by="listHTTPport", all = TRUE)
  
    
  ##########################################################	DNS
  DNS<-mydataNetwork[['dns']]
  listDNShostname2 = list()

  if (length(DNS)==0){
    newlistDNShostname<-data.frame(listDNShostname=character(0), Freq = numeric(0))
  } else {
    for(i in DNS) {
      listDNShostname2 <- c(listDNShostname2, i[['hostname']])
    }
    listDNShostname<-sapply(listDNShostname2, function(x) x[[1]])
    newlistDNShostname<-as.data.frame(table(listDNShostname))
  }
  DATA_NET_DNS_HOST <- merge(DATA_NET_DNS_HOST, newlistDNShostname, by="listDNShostname", all = TRUE)

  
  ##########################################################	HOSTS
  
  
  if (length(UDP)==0){
    newlistHosts<-data.frame(listHosts=character(0), Freq = numeric(0))

  } else {
    listHosts<-mydataNetwork[['hosts']]
    newlistHosts<-as.data.frame(table(listHosts))
  }

  DATA_NET_HOSTS <- merge(DATA_NET_HOSTS, newlistHosts, by="listHosts", all = TRUE)
  
  ##########################################################
  
  #____________ SUMMARY ______________________________________________________________________________________________
  
  ##########################################################	FILES
  SUMFiles<-mydataSummary[[1]][['files']]
  if (length(SUMFiles)==0){
    newlistSUMFilesdistcount<-data.frame(SUMFiles=character(0), Freq = numeric(0))
  } else {
    newlistSUMFilesdistcount<-as.data.frame(table(SUMFiles))
  }
  DATA_SUM_FILES <- merge(DATA_SUM_FILES, newlistSUMFilesdistcount, by="SUMFiles", all = TRUE)
  
  ##########################################################	KEYS
  SUMKeys<-mydataSummary[[1]][['keys']]
  if (length(SUMKeys)==0){
    newlistSUMKeysdistcount<-data.frame(SUMKeys=character(0), Freq = numeric(0))
  } else {
    newlistSUMKeysdistcount<-as.data.frame(table(SUMKeys))
  }
  DATA_SUM_KEYS <- merge(DATA_SUM_KEYS, newlistSUMKeysdistcount, by="SUMKeys", all = TRUE)
  
  ##########################################################	MUTEXES
  SUMMutexes<-mydataSummary[[1]][['mutexes']]
  if (length(SUMMutexes)==0){
    newlistSUMMutexesdistcount<-data.frame(SUMMutexes=character(0), Freq = numeric(0))
  } else {
    newlistSUMMutexesdistcount<-as.data.frame(table(SUMMutexes))
  }
  DATA_SUM_MUTEXES <- merge(DATA_SUM_MUTEXES, newlistSUMMutexesdistcount, by="SUMMutexes", all = TRUE)
  
  
  
  #____________ PROCESS TREE ______________________________________________________________________________________________
  
  ##########################################################	Process Tree NAME
  PTName<-mydataProcessTree[[1]][[1]][['name']]
  
  if (length(PTName)==0){
    newlistPTNamedistcount<-data.frame(listPTName=character(0), Freq = numeric(0))
  } else {
    PTlist1 <- c(PTlist1, PTName)
    PTlist1<-c(PTlist1, recursiveTree1(mydataProcessTree[[1]][[1]][['children']]))
    listPTName <- sapply(PTlist1, function(x) x[[1]])
    newlistPTNamedistcount<-as.data.frame(table(listPTName))
  }
  DATA_PT_NAME <- merge(DATA_PT_NAME, newlistPTNamedistcount, by="listPTName", all = TRUE)
  
  ##########################################################	Process Tree PID
  
  PTPid<-mydataProcessTree[[1]][[1]][['pid']]
  
  if (length(PTPid)==0){
    newlistPTPiddistcount<-data.frame(listPTPid=character(0), Freq = numeric(0))
  } else {
    PTlist2 <- c(PTlist2, PTPid)
    PTlist2 <- c(PTlist2, recursiveTree2(mydataProcessTree[[1]][[1]][['children']]))
    listPTPid <- sapply(PTlist2, function(x) x[[1]])
    newlistPTPiddistcount<-as.data.frame(table(listPTPid))
  }
  
  DATA_PT_PID <- merge(DATA_PT_PID, newlistPTPiddistcount, by="listPTPid", all = TRUE)
  
  ##########################################################
  
  #___________________ PROCESSES __________________________________________________________________________________

  
  ##########################################################	FIRST_SEEN, PARENT_ID, PROCESS_ID
  ##########################################################  NGRAMS, API, CATEGORY, RETURN, STATUS, ARGUMENTS (NAME, VALUE)
  if (length(mydataProcessesONE[[1]])==0){
    
    newlistFirstSeendistcount<-data.frame(listFirstSeen=character(0), Freq = numeric(0))
    newlistParentIddistcount<-data.frame(listParentId=character(0), Freq = numeric(0))
    newlistProcessIddistcount<-data.frame(listProcessId=character(0), Freq = numeric(0))
    newlistProcessNamedistcount<-data.frame(listProcessName=character(0), Freq = numeric(0))
    
    newlistNGRAMS2distcount<-data.frame(ngram2=character(0), Freq = numeric(0))
    newlistNGRAMS3distcount<-data.frame(ngram3=character(0), Freq = numeric(0))
    newlistNGRAMS4distcount<-data.frame(ngram4=character(0), Freq = numeric(0))
    
    newlistAPIdistcountONE<-data.frame(listAPIONE=character(0), Freq = numeric(0))
    newlistCategorydistcountONE<-data.frame(listCategoryONE=character(0), Freq = numeric(0))
    newlistRETURNdistcountONE<-data.frame(listRETURNONE=character(0), Freq = numeric(0))
    newlistSTATUSdistcountONE<-data.frame(listSTATUSONE=character(0), Freq = numeric(0))
    newlistARGUMENTSdistcount_NAME<-data.frame(listARGUMENT_NAME=character(0), Freq = numeric(0))
    newlistARGUMENTSdistcount_VALUE<-data.frame(listARGUMENT_VALUE=character(0), Freq = numeric(0))
    
  } else {
    
    for(i in mydataProcessesONE[[1]]) {
      
      FirstSeen<-i[['first_seen']] 
      listFirstSeen2<- c(listFirstSeen2, FirstSeen)
      ParentId<-i[['parent_id']]
      listParentId2<- c(listParentId2, ParentId)
      ProcessId<-i[['process_id']]
      listProcessId2<- c(listProcessId2, ProcessId)
      ProcessName<-i[['process_name']]
      listProcessName2<- c(listProcessName2, ProcessName)
      
      mydataCallsONEV2<-i[['calls']] 
      
      if (length(mydataCallsONEV2)==0){
        
      } else {
        for(i in mydataCallsONEV2) {
          api_str <- i[['api']]
          category_str <- i[['category']]
          return_str <-i[['return']]
          status_str <-i[['status']]
          arg_list <- i[['arguments']]
          #concat_str <- paste(api_str,'|',category_str)
          #ngram2V1<- c(ngram2V1, concat_str)
          
          listAPI2<- c(listAPI2, api_str)
          listCategory2<- c(listCategory2, category_str)
          listReturn2<- c(listReturn2, return_str)
          listStatus2<- c(listStatus2, status_str)
          
          for(j in arg_list){
            arg_name_str <- j[['name']]
            arg_value_str <- j[['value']]
            
            listArg_Name2<- c(listArg_Name2, arg_name_str)
            listArg_Value2<- c(listArg_Value2, arg_value_str)
            
          }
        }
      }

    }
    
    
    listFirstSeen<-sapply(listFirstSeen2, function(x) x[[1]])
    newlistFirstSeendistcount<-as.data.frame(table(listFirstSeen))
    listParentId<-sapply(listParentId2, function(x) x[[1]])
    newlistParentIddistcount<-as.data.frame(table(listParentId))
    listProcessId<-sapply(listProcessId2, function(x) x[[1]])
    newlistProcessIddistcount<-as.data.frame(table(listProcessId))
    listProcessName<-sapply(listProcessName2, function(x) x[[1]])
    newlistProcessNamedistcount<-as.data.frame(table(listProcessName))
    
    listAPIONE<-sapply(listAPI2, function(x) x[[1]])
    newlistAPIdistcountONE<-data.frame(table(listAPIONE))
    listCategoryONE<-sapply(listCategory2, function(x) x[[1]])
    newlistCategorydistcountONE<-as.data.frame(table(listCategoryONE))
    listRETURNONE<-sapply(listReturn2, function(x) x[[1]])
    newlistRETURNdistcountONE<-as.data.frame(table(listRETURNONE))
    listSTATUSONE<-sapply(listStatus2, function(x) x[[1]])
    newlistSTATUSdistcountONE<-as.data.frame(table(listSTATUSONE))
    listARGUMENT_NAME <- sapply(listArg_Name2, function(x) x[[1]])
    newlistARGUMENTSdistcount_NAME<-as.data.frame(table(listARGUMENT_NAME))
    listARGUMENT_VALUE <- sapply(listArg_Value2, function(x) x[[1]])
    newlistARGUMENTSdistcount_VALUE<-as.data.frame(table(listARGUMENT_VALUE))
    
  }
  
  #Merging Data
  DATA_FIRST_SEEN <- merge(DATA_FIRST_SEEN, newlistFirstSeendistcount, by="listFirstSeen", all = TRUE)
  DATA_PARENT_ID <- merge(DATA_PARENT_ID, newlistParentIddistcount, by="listParentId", all = TRUE)
  DATA_PROCESS_ID <- merge(DATA_PROCESS_ID, newlistProcessIddistcount, by="listProcessId", all = TRUE)
  DATA_PROCESS_NAME <- merge(DATA_PROCESS_NAME, newlistProcessNamedistcount, by="listProcessName", all = TRUE) 
  DATA_API <- merge(DATA_API, newlistAPIdistcountONE, by="listAPIONE", all = TRUE)
  DATA_CATEGORY <- merge(DATA_CATEGORY, newlistCategorydistcountONE, by="listCategoryONE", all = TRUE)
  DATA_RETURN <- merge(DATA_RETURN, newlistRETURNdistcountONE, by="listRETURNONE", all = TRUE)
  DATA_STATUS <- merge(DATA_STATUS, newlistSTATUSdistcountONE, by="listSTATUSONE", all = TRUE)
  DATA_ARGUMENTS_NAME <- merge(DATA_ARGUMENTS_NAME, newlistARGUMENTSdistcount_NAME, by="listARGUMENT_NAME", all = TRUE)
  DATA_ARGUMENTS_VALUE <- merge(DATA_ARGUMENTS_VALUE, newlistARGUMENTSdistcount_VALUE, by="listARGUMENT_VALUE", all = TRUE)
  
  
  ########################################################## 
  ##########################################################
  x.num <- x.num+1
}


##DATA was grouped and writed on 26 files T1 to T26. C'X' refers to subBlocks of the original dataset 

DATA_SUM_FILES <- DATA_SUM_FILES[,-(2), drop=FALSE]
NumberCols <- as.numeric(ncol(DATA_SUM_FILES))
colnames(DATA_SUM_FILES)<-seq(1, NumberCols, by=1)
write.table(DATA_SUM_FILES, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T1.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_SUM_KEYS <- DATA_SUM_KEYS[,-(2), drop=FALSE]
colnames(DATA_SUM_KEYS)<-seq(1, NumberCols, by=1)
write.table(DATA_SUM_KEYS, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T2.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_SUM_MUTEXES <- DATA_SUM_MUTEXES[,-(2), drop=FALSE]
colnames(DATA_SUM_MUTEXES)<-seq(1, NumberCols, by=1)
write.table(DATA_SUM_MUTEXES, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T3.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_API <- DATA_API[,-(2), drop=FALSE]
colnames(DATA_API)<-seq(1, NumberCols, by=1)
write.table(DATA_API, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T4.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_CATEGORY <- DATA_CATEGORY[,-(2), drop=FALSE]
colnames(DATA_CATEGORY)<-seq(1, NumberCols, by=1)
write.table(DATA_CATEGORY, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T5.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_RETURN <- DATA_RETURN[,-(2), drop=FALSE]
colnames(DATA_RETURN)<-seq(1, NumberCols, by=1)
write.table(DATA_RETURN, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T6.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_STATUS <- DATA_STATUS[,-(2), drop=FALSE]
colnames(DATA_STATUS)<-seq(1, NumberCols, by=1)
write.table(DATA_STATUS, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T7.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_ARGUMENTS_NAME <- DATA_ARGUMENTS_NAME[,-(2), drop=FALSE]
colnames(DATA_ARGUMENTS_NAME)<-seq(1, NumberCols, by=1)
write.table(DATA_ARGUMENTS_NAME, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T8.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_ARGUMENTS_VALUE <- DATA_ARGUMENTS_VALUE[,-(2), drop=FALSE]
colnames(DATA_ARGUMENTS_VALUE)<-seq(1, NumberCols, by=1)
write.table(DATA_ARGUMENTS_VALUE, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T9.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_FIRST_SEEN <- DATA_FIRST_SEEN[,-(2), drop=FALSE]
colnames(DATA_FIRST_SEEN)<-seq(1, NumberCols, by=1)
write.table(DATA_FIRST_SEEN, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T10.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_PARENT_ID <- DATA_PARENT_ID[,-(2), drop=FALSE]
colnames(DATA_PARENT_ID)<-seq(1, NumberCols, by=1)
write.table(DATA_PARENT_ID, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T11.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_PROCESS_ID <- DATA_PROCESS_ID[,-(2), drop=FALSE]
colnames(DATA_PROCESS_ID)<-seq(1, NumberCols, by=1)
write.table(DATA_PROCESS_ID, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T12.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_PROCESS_NAME <- DATA_PROCESS_NAME[,-(2), drop=FALSE]
colnames(DATA_PROCESS_NAME)<-seq(1, NumberCols, by=1)
write.table(DATA_PROCESS_NAME, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T13.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_PT_PID <- DATA_PT_PID[,-(2), drop=FALSE]
colnames(DATA_PT_PID)<-seq(1, NumberCols, by=1)
write.table(DATA_PT_PID, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T14.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_PT_NAME <- DATA_PT_NAME[,-(2), drop=FALSE]
colnames(DATA_PT_NAME)<-seq(1, NumberCols, by=1)
write.table(DATA_PT_NAME, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T15.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_NET_UDP_DPORT <- DATA_NET_UDP_DPORT[,-(2), drop=FALSE]
colnames(DATA_NET_UDP_DPORT)<-seq(1, NumberCols, by=1)
write.table(DATA_NET_UDP_DPORT, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T16.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_NET_UDP_SPORT <- DATA_NET_UDP_SPORT[,-(2), drop=FALSE]
colnames(DATA_NET_UDP_SPORT)<-seq(1, NumberCols, by=1)
write.table(DATA_NET_UDP_SPORT, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T17.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_NET_UDP_DST <- DATA_NET_UDP_DST[,-(2), drop=FALSE]
colnames(DATA_NET_UDP_DST)<-seq(1, NumberCols, by=1)
write.table(DATA_NET_UDP_DST, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T18.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_NET_HOSTS <- DATA_NET_HOSTS[,-(2), drop=FALSE]
colnames(DATA_NET_HOSTS)<-seq(1, NumberCols, by=1)
write.table(DATA_NET_HOSTS, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T19.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_NET_DNS_HOST <- DATA_NET_DNS_HOST[,-(2), drop=FALSE]
colnames(DATA_NET_DNS_HOST)<-seq(1, NumberCols, by=1)
write.table(DATA_NET_DNS_HOST, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T20.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_NET_HTTP_HOST <- DATA_NET_HTTP_HOST[,-(2), drop=FALSE]
colnames(DATA_NET_HTTP_HOST)<-seq(1, NumberCols, by=1)
write.table(DATA_NET_HTTP_HOST, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T21.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_NET_HTTP_URI <- DATA_NET_HTTP_URI[,-(2), drop=FALSE]
colnames(DATA_NET_HTTP_URI)<-seq(1, NumberCols, by=1)
write.table(DATA_NET_HTTP_URI, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T22.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_NET_HTTP_PORT <- DATA_NET_HTTP_PORT[,-(2), drop=FALSE]
colnames(DATA_NET_HTTP_PORT)<-seq(1, NumberCols, by=1)
write.table(DATA_NET_HTTP_PORT, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T23.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_NET_TCP_DPORT <- DATA_NET_TCP_DPORT[,-(2), drop=FALSE]
colnames(DATA_NET_TCP_DPORT)<-seq(1, NumberCols, by=1)
write.table(DATA_NET_TCP_DPORT, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T24.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_NET_TCP_SPORT <- DATA_NET_TCP_SPORT[,-(2), drop=FALSE]
colnames(DATA_NET_TCP_SPORT)<-seq(1, NumberCols, by=1)
write.table(DATA_NET_TCP_SPORT, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T25.csv", sep = ",", col.names = NA, qmethod = "double")

DATA_NET_TCP_DST <- DATA_NET_TCP_DST[,-(2), drop=FALSE]
colnames(DATA_NET_TCP_DST)<-seq(1, NumberCols, by=1)
write.table(DATA_NET_TCP_DST, file = "/home/gpulab0/Documents/CARLOSCM/VirusTotal/Results/JOINED/BH/C8T26.csv", sep = ",", col.names = NA, qmethod = "double")



