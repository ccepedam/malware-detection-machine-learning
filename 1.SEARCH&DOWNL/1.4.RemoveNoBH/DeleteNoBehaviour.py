#This program removes files with behavioural content Null (sometimes behavioural info is empty) and its corresponding "Report_all" pair

#!/usr/bin/python

import sys
import requests
import json
import simplejson as json
import time
import os, sys

header = 'behaviour'
header2 = 'ReportAll'

header3 = 'B'
header4 = 'R'

extension = '.json'

counter = 1
counter2 = 1

myfile = ""
myfile2 = ""
mainpath = '/path/Behaviour/'
mainpath2 = '/path/ReportAll/'

newfile=""

MaximumNumberOfFiles = 20000
while counter<=MaximumNumberOfFiles:
	print(counter)	
	myfile = mainpath + header + str(counter) + extension
	myfile2 = mainpath2 + header2 + str(counter) + extension
	myfile3 = mainpath + str(counter2) + header3 + extension
	myfile4 = mainpath2 + str(counter2) + header4 + extension
	input_file=open(myfile, 'r')
	json_decode=json.load(input_file) 
	
	try:
		q=json_decode['behavior']
	except KeyError:
		q = None
	
	if q is None:
		
		os.remove(myfile)
		os.remove(myfile2)
		print ("Removed file: " + str(counter))
		with open('HashesRemoved.txt', 'a') as file:
    			file.write(str(counter) +'\n')
	else:
		input_file2=open(myfile2, 'r')
		json_decode2=json.load(input_file2) 
		finalHash=json_decode2['sha256']
		with open('HFinal.txt', 'a') as file:
    			file.write(finalHash +'\n')
		os.renames(myfile, myfile3)
		os.renames(myfile2, myfile4)
		counter2 = counter2 + 1

	counter = counter + 1
	
    
