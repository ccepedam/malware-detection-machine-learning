#This program reques for the Report-All (the complete list of extrated info - no behavior) information for each hash in Hashes.txt
#!/usr/bin/python

import sys
import requests
import json
import time
import urllib
import simplejson
import urllib2
import io


mainpath = '/path/'
header = 'ReportAll_MalwNew'
extension = '.json'
counter = 1

myfile = ""
currentHash = ""

hash_file=open('/path/Hashes.txt', 'r')
for cur in hash_file:
    currentHash = cur
    myfile = mainpath + header + str(counter) + extension
    params = {'apikey': 'XXXX', 'resource': currentHash, 'allinfo': '1'}
    response = requests.get('https://www.virustotal.com/vtapi/v2/file/report', params=params)
    json_response = response.json()
    with open(myfile, 'w') as outfile:
        json.dump(json_response, outfile, indent=2, sort_keys=True)
    print(counter)    
    counter = counter+1
    
